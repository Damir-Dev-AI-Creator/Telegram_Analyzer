# bot/handlers/start.py
"""ะะฑัะฐะฑะพััะธะบะธ ะฑะฐะทะพะฒัั ะบะพะผะฐะฝะด: /start, /help"""

from aiogram import Router, F
from aiogram.filters import Command, CommandStart
from aiogram.types import Message
import logging

logger = logging.getLogger(__name__)

# ะกะพะทะดะฐะตะผ router ะดะปั ััะพะณะพ ะผะพะดัะปั
router = Router()


@router.message(CommandStart())
async def cmd_start(message: Message):
    """
    ะะฑัะฐะฑะพััะธะบ ะบะพะผะฐะฝะดั /start
    ะัะธะฒะตัััะฒะธะต ะธ ะบัะฐัะบะพะต ะพะฟะธัะฐะฝะธะต ะฒะพะทะผะพะถะฝะพััะตะน
    """
    logger.info(f"User {message.from_user.id} started the bot")

    await message.answer(
        "๐ฏ <b>Telegram Analyzer Bot</b>\n\n"
        "ะัะธะฒะตั! ะฏ ะฟะพะผะพะณั ัะบัะฟะพััะธัะพะฒะฐัั ะฒะฐัะธ Telegram ัะฐัั ะฒ CSV ัะพัะผะฐั "
        "ะธ ะฐะฝะฐะปะธะทะธัะพะฒะฐัั ะธั ัะตัะตะท Claude API.\n\n"
        "<b>๐ ะะพะทะผะพะถะฝะพััะธ:</b>\n"
        "โข ะญะบัะฟะพัั ะธััะพัะธะธ ัะพะพะฑัะตะฝะธะน ะธะท ะปัะฑะพะณะพ ัะฐัะฐ\n"
        "โข ะะฝะฐะปะธะท ัะฐัะพะฒ ัะตัะตะท Claude API (Opus 4.5)\n"
        "โข ะะพะดะดะตัะถะบะฐ ะบะฐะฝะฐะปะพะฒ, ะณััะฟะฟ ะธ ะปะธัะฝัั ัะฐัะพะฒ\n"
        "โข ะัะธะฝััะพะฝะฝะฐั ะพะฑัะฐะฑะพัะบะฐ (ะฝะต ะฑะปะพะบะธััะตั ะฑะพัะฐ)\n"
        "โข ะัััััะน ัะบัะฟะพัั ัะตัะตะท MTProto API\n\n"
        "<b>๐ ะัััััะน ััะฐัั:</b>\n"
        "1. /export @channel - ะญะบัะฟะพัั ัะฐัะฐ\n"
        "2. /analyze ัะฐะนะป.csv - ะะฝะฐะปะธะท ัะตัะตะท Claude\n"
        "3. /exportanalyze @channel - ะญะบัะฟะพัั + ะฐะฝะฐะปะธะท\n\n"
        "<b>๐ ะะพะผะฐะฝะดั:</b>\n"
        "/export - ะญะบัะฟะพัั ัะฐัะฐ\n"
        "/analyze - ะะฝะฐะปะธะท ัะตัะตะท Claude API\n"
        "/exportanalyze - ะญะบัะฟะพัั + ะฐะฝะฐะปะธะท\n"
        "/help - ะะพะดัะพะฑะฝะฐั ัะฟัะฐะฒะบะฐ\n\n"
        "ะัะฟะพะปัะทัะนัะต /help ะดะปั ะฟะพะดัะพะฑะฝัั ะธะฝััััะบัะธะน."
    )


@router.message(Command("help"))
async def cmd_help(message: Message):
    """
    ะะฑัะฐะฑะพััะธะบ ะบะพะผะฐะฝะดั /help
    ะะพะดัะพะฑะฝะฐั ัะฟัะฐะฒะบะฐ ะฟะพ ะธัะฟะพะปัะทะพะฒะฐะฝะธั
    """
    logger.info(f"User {message.from_user.id} requested help")

    help_text = """
<b>๐ ะะพะดัะพะฑะฝะฐั ัะฟัะฐะฒะบะฐ</b>

โโโโโโโโโโโโโโโโโโโโโโ

<b>๐ ะะะะะะะ /export</b>

ะญะบัะฟะพััะธััะตั ัะฐั ะฒ CSV ัะฐะนะป

<b>ะคะพัะผะฐั:</b>
<code>/export CHAT_ID</code>

<b>ะะดะต CHAT_ID:</b>
โข ะงะธัะปะพะฒะพะน ID: <code>-1001234567890</code>
โข Username: <code>@channelname</code>
โข ะกััะปะบะฐ: <code>https://t.me/channelname</code>

<b>ะัะธะผะตัั:</b>
<code>/export -1001234567890</code>
<code>/export @durov</code>

โโโโโโโโโโโโโโโโโโโโโโ

<b>๐ค ะะะะะะะ /analyze</b>

ะะฝะฐะปะธะทะธััะตั CSV ัะฐะนะป ัะตัะตะท Claude API

<b>ะคะพัะผะฐั 1:</b> ะัะธะบัะตะฟะธัะต CSV ัะฐะนะป ะบ ะบะพะผะฐะฝะดะต
<code>/analyze</code> (+ ัะฐะนะป)

<b>ะคะพัะผะฐั 2:</b> ะฃะบะฐะถะธัะต ะธะผั ัะฐะนะปะฐ
<code>/analyze ะธะผั_ัะฐะนะปะฐ.csv</code>

<b>ะงัะพ ะดะตะปะฐะตั:</b>
โข ะะฝะฐะปะธะทะธััะตั ัะพะพะฑัะตะฝะธั ัะตัะตะท Claude Sonnet 4
โข ะััะฒะปัะตั ัะฐัััะต ะทะฐะฟัะพัั ะบะปะธะตะฝัะพะฒ
โข ะะฐัะพะดะธั ะฟัะธัะธะฝั ะบะพะฝัะปะธะบัะพะฒ
โข ะกัะธัะฐะตั ััะฐัะธััะธะบั ะฟะพ ะผะตะฝะตะดะถะตัะฐะผ
โข ะะฝะฐะปะธะทะธััะตั ะฒัะตะผั ะพัะฒะตัะฐ

<b>ะะตะทัะปััะฐั:</b> DOCX ัะฐะนะป ั ะฟะพะดัะพะฑะฝัะผ ะฐะฝะฐะปะธะทะพะผ

โโโโโโโโโโโโโโโโโโโโโโ

<b>โก ะะะะะะะ /exportanalyze</b>

ะญะบัะฟะพัั + ะฐะฝะฐะปะธะท ะพะดะฝะพะน ะบะพะผะฐะฝะดะพะน

<b>ะคะพัะผะฐั:</b>
<code>/exportanalyze CHAT_ID</code>

<b>ะัะธะผะตัั:</b>
<code>/exportanalyze @support_chat</code>
<code>/exportanalyze -1001234567890</code>

<b>ะงัะพ ะดะตะปะฐะตั:</b>
1. ะญะบัะฟะพััะธััะตั ัะฐั ะฒ CSV (~30 ัะตะบ)
2. ะะฝะฐะปะธะทะธััะตั ัะตัะตะท Claude API (~1-3 ะผะธะฝ)
3. ะัะฟัะฐะฒะปัะตั ะพะฑะฐ ัะฐะนะปะฐ (CSV + DOCX)

โโโโโโโโโโโโโโโโโโโโโโ

<b>๐ ะะฐะบ ะฝะฐะนัะธ Chat ID:</b>

<b>ะะตัะพะด 1:</b> @userinfobot
ะะตัะตัะปะธัะต ัะพะพะฑัะตะฝะธะต ะธะท ัะฐัะฐ ะฑะพัั

<b>ะะตัะพะด 2:</b> ะะตะฑ-ะฒะตััะธั
https://web.telegram.org โ ะพัะบัะพะนัะต ัะฐั โ ID ะฒ URL

<b>ะะตัะพะด 3:</b> ะัะฑะปะธัะฝัะต ะบะฐะฝะฐะปั
ะัะฟะพะปัะทัะนัะต @username ะธะปะธ t.me ัััะปะบั

โโโโโโโโโโโโโโโโโโโโโโ

<b>โ๏ธ ะัะพะฑะตะฝะฝะพััะธ:</b>

<b>ะัะธะฝััะพะฝะฝะฐั ะพะฑัะฐะฑะพัะบะฐ:</b>
โข ะะพั ะพัะฒะตัะฐะตั ะผะณะฝะพะฒะตะฝะฝะพ
โข ะะฐะดะฐัะธ ะฒัะฟะพะปะฝััััั ะฒ ัะพะฝะต
โข ะฃะฒะตะดะพะผะปะตะฝะธั ะพ ะทะฐะฒะตััะตะฝะธะธ
โข ะะพะถะฝะพ ะทะฐะฟััะบะฐัั ะฝะตัะบะพะปัะบะพ ะทะฐะดะฐั

<b>ะขัะตะฑะพะฒะฐะฝะธั:</b>
โ ะั ะดะพะปะถะฝั ะฑััั ััะฐััะฝะธะบะพะผ ัะฐัะฐ
โ ะะฐัััะพะตะฝั API_ID, API_HASH, PHONE
โ ะะปั ะฐะฝะฐะปะธะทะฐ ะฝัะถะตะฝ CLAUDE_API_KEY

โโโโโโโโโโโโโโโโโโโโโโ

<b>๐ฌ ะัะต ะบะพะผะฐะฝะดั:</b>

/start - ะะปะฐะฒะฝะพะต ะผะตะฝั
/export - ะญะบัะฟะพัั ัะฐัะฐ
/analyze - ะะฝะฐะปะธะท ัะตัะตะท Claude
/exportanalyze - ะญะบัะฟะพัั + ะฐะฝะฐะปะธะท
/help - ะญัะฐ ัะฟัะฐะฒะบะฐ

โโโโโโโโโโโโโโโโโโโโโโ

<b>๐ ะัััััะน ะฟัะธะผะตั:</b>

<code>/exportanalyze @my_support_chat</code>

ะงะตัะตะท ะฝะตัะบะพะปัะบะพ ะผะธะฝัั ะฟะพะปััะธัะต:
โข CSV ั ะธััะพัะธะตะน ัะพะพะฑัะตะฝะธะน
โข DOCX ั ะฐะฝะฐะปะธะทะพะผ ะพั Claude
"""

    await message.answer(help_text)
